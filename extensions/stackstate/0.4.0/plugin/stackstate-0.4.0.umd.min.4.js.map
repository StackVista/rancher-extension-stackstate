{"version":3,"sources":["webpack://stackstate-0.4.0/./components/Health/HealthState.vue?a959","webpack://stackstate-0.4.0/./components/MonitorTab.vue","webpack://stackstate-0.4.0//home/runner/work/rancher-extension-stackstate/rancher-extension-stackstate/node_modules/@rancher/shell/components/formatter/LiveDate.vue","webpack://stackstate-0.4.0//home/runner/work/rancher-extension-stackstate/rancher-extension-stackstate/node_modules/@rancher/shell/utils/time.js","webpack://stackstate-0.4.0/../../node_modules/@rancher/shell/components/formatter/LiveDate.vue","webpack://stackstate-0.4.0//home/runner/work/rancher-extension-stackstate/rancher-extension-stackstate/node_modules/@rancher/shell/components/formatter/LiveDate.vue?c0a8","webpack://stackstate-0.4.0//home/runner/work/rancher-extension-stackstate/rancher-extension-stackstate/node_modules/@rancher/shell/components/formatter/LiveDate.vue?bc58","webpack://stackstate-0.4.0/components/MonitorTab.vue","webpack://stackstate-0.4.0/./components/MonitorTab.vue?e30c","webpack://stackstate-0.4.0/./components/MonitorTab.vue?ac6a","webpack://stackstate-0.4.0/./components/Health/HealthState.vue","webpack://stackstate-0.4.0/components/Health/HealthState.vue","webpack://stackstate-0.4.0/./components/Health/HealthState.vue?54e3","webpack://stackstate-0.4.0/./components/Health/HealthState.vue?eb5b","webpack://stackstate-0.4.0/./components/MonitorTab.vue?d162","webpack://stackstate-0.4.0/./components/MonitorTab.vue?2b6d","webpack://stackstate-0.4.0/./components/Health/HealthState.vue?fa56","webpack://stackstate-0.4.0/./components/MonitorTab.vue?1fc2","webpack://stackstate-0.4.0/./components/Health/HealthState.vue?8448","webpack://stackstate-0.4.0/./modules/observed.ts"],"names":["___CSS_LOADER_API_IMPORT___","exports","push","module","i","render","_vm","this","_c","_self","observed","hasMonitors","staticClass","attrs","_m","_l","monitors","mon","key","checkStateId","health","url","encodeURIComponent","urn","_v","_s","name","lastUpdateTimestamp","staticRenderFns","suffixedLabel","showTooltip","directives","rawName","value","content","title","placement","tooltipPlacement","expression","FACTORS","LABELS","diffFrom","from","t","now","day","diff","absDiff","Math","abs","next","label","length","floor","ret","unitsKey","units","string","count","props","type","String","Number","default","addSuffix","Boolean","addPrefix","suffix","mounted","liveUpdate","data","computed","dateFormat","escapeHtml","$store","getters","DATE_FORMAT","timeFormat","TIME_FORMAT","out","format","exists","suffixKey","dayValue","watch","methods","prefix","trim","components","HealthState","LiveDate","resource","Object","mapGetters","clusterId","_this$currentCluster","currentCluster","id","componentIdentifier","_this$currentCluster2","cluster","spec","displayName","identifier","metadata","namespace","mapKind","toLowerCase","obs","isStackStateObserved","creds","loadStackStateSettings","component","loadComponent","syncedCheckStates","class","badgeColor","state","color","__esModule","locals","add","async","store","response","dispatch","filter","depl","labels"],"mappings":"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","file":"stackstate-0.4.0.umd.min.4.js","sourcesContent":["// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../node_modules/@vue/cli-service/node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".healthstate-green[data-v-a8e366d2]{color:#2b9e40;border-color:#2b9e40}.healthstate-orange[data-v-a8e366d2]{color:#ff8a1e;border-color:#ff8a1e}.healthstate-red[data-v-a8e366d2]{border-color:#eb5757;color:#eb5757}.healthstate-grey[data-v-a8e366d2]{border-color:#878e98;color:#878e98}.healthstate-green[data-v-a8e366d2],.healthstate-grey[data-v-a8e366d2],.healthstate-orange[data-v-a8e366d2],.healthstate-red[data-v-a8e366d2]{display:inline-block;border-width:1px;border-style:solid;border-radius:20px;padding:2px 10px;height:21px;line-height:16px;text-transform:uppercase;font-size:.75rem;letter-spacing:.3px;font-weight:500}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","var render = function render(){var _vm=this,_c=_vm._self._c;return (!_vm.observed)?_c('div',[_vm._m(0)]):(!_vm.hasMonitors)?_c('div',[_vm._m(1)]):_c('div',{staticClass:\"sortable-table-list-container\"},[_c('table',{staticClass:\"sortable-table top-divider\",attrs:{\"width\":\"100%\"}},[_vm._m(2),_c('tbody',_vm._l((_vm.monitors),function(mon){return _c('tr',{key:mon.checkStateId,staticClass:\"main-row\"},[_c('td',{staticClass:\"col-badge-state-formatter\",attrs:{\"align\":\"center\"}},[_c('HealthState',{attrs:{\"state\":mon.health}})],1),_c('td',[_c('a',{attrs:{\"href\":`https://${_vm.url}/#/components/${encodeURIComponent(_vm.urn)}`,\"target\":\"_blank\"}},[_vm._v(_vm._s(mon.name))])]),_c('td',[_c('LiveDate',{attrs:{\"value\":mon.lastUpdateTimestamp}})],1)])}),0)])])\n}\nvar staticRenderFns = [function (){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"card\"},[_c('span',[_vm._v(\"Rancher Observability is not enabled for this cluster.\")])])\n},function (){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"card\"},[_c('span',[_vm._v(\"No monitors found for this component.\")])])\n},function (){var _vm=this,_c=_vm._self._c;return _c('thead',[_c('tr',[_c('th',{staticClass:\"sortable\",attrs:{\"align\":\"left\",\"width\":\"110px\"}},[_c('div',{staticClass:\"table-header-container\"},[_c('span',[_vm._v(\"State\")])])]),_c('th',{attrs:{\"align\":\"left\"}},[_c('div',{staticClass:\"table-header-container\"},[_c('span',[_vm._v(\"Monitor\")])])]),_c('th',{attrs:{\"align\":\"left\"}},[_c('div',{staticClass:\"table-header-container\"},[_c('span',[_vm._v(\"Last update\")])])])])])\n}]\n\nexport { render, staticRenderFns }","var render = function render(){var _vm=this,_c=_vm._self._c;return (!_vm.suffixedLabel)?_c('span',{staticClass:\"text-muted\"},[_vm._v(\" â€” \")]):(_vm.showTooltip)?_c('span',{directives:[{name:\"clean-tooltip\",rawName:\"v-clean-tooltip\",value:({content: _vm.title, placement: _vm.tooltipPlacement}),expression:\"{content: title, placement: tooltipPlacement}\"}],staticClass:\"live-date\"},[_vm._v(\" \"+_vm._s(_vm.suffixedLabel)+\" \")]):_c('span',{staticClass:\"live-date\"},[_vm._v(\" \"+_vm._s(_vm.suffixedLabel)+\" \")])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import day from 'dayjs';\n\nconst FACTORS = [60, 60, 24];\nconst LABELS = ['sec', 'min', 'hour', 'day'];\n\n// Diff two dates and return an object with values for presentation\n// If 't' is also passed, 'string' property is set on the return object with the diff formatted as a string\n// e.g. formats a date difference to return '1 day', '20 hours' etc\nexport function diffFrom(value, from, t) {\n  const now = day();\n\n  from = from || now;\n  const diff = value.diff(from, 'seconds');\n\n  let absDiff = Math.abs(diff);\n\n  let next = 1;\n  let label = '?';\n\n  let i = 0;\n\n  while ( absDiff >= FACTORS[i] && i < FACTORS.length ) {\n    absDiff /= FACTORS[i];\n    next *= Math.floor(FACTORS[i] / 10);\n    i++;\n  }\n\n  if ( absDiff < 5 ) {\n    label = Math.floor(absDiff * 10) / 10;\n  } else {\n    label = Math.floor(absDiff);\n  }\n  const ret = {\n    diff,\n    absDiff,\n    label,\n    unitsKey: `unit.${ LABELS[i] }`,\n    units:    LABELS[i],\n    next,\n  };\n\n  if (!!t) {\n    ret.string = `${ ret.label } ${ t(ret.unitsKey, { count: ret.label }) }`;\n  }\n\n  return ret;\n}\n\nexport function safeSetTimeout(timeout, callback, that) {\n  if (timeout <= 2147483647) {\n    // Max value setTimeout can take is max 32 bit int (about 24.9 days)\n    return setTimeout(() => {\n      callback.apply(that);\n    }, timeout);\n  }\n}\n\nexport function getSecondsDiff(startDate, endDate) {\n  return Math.round(\n    Math.abs(Date.parse(endDate) - Date.parse(startDate)) / 1000\n  );\n}\n\n/**\n * return { diff: number; label: string }\n *\n * diff:  update frequency in seconds\n * label: content of the cell's column\n */\nexport function elapsedTime(seconds) {\n  if (!seconds) {\n    return {};\n  }\n\n  if (seconds < 120) {\n    return {\n      diff:  1,\n      label: `${ seconds }s`\n    };\n  }\n\n  const minutes = Math.floor(seconds / 60);\n\n  if (minutes < 10) {\n    return {\n      diff:  1,\n      label: `${ minutes }m${ seconds - (minutes * 60) }s`\n    };\n  }\n\n  const hours = Math.floor(seconds / 3600);\n\n  if (hours < 3) {\n    return {\n      diff:  60,\n      label: `${ minutes }m`,\n    };\n  }\n\n  const days = Math.floor(seconds / (3600 * 24));\n\n  if (days > 1) {\n    return {\n      diff:  60,\n      label: `${ days }d${ hours - (days * 24) }h`,\n    };\n  }\n\n  if (hours > 7) {\n    return {\n      diff:  60,\n      label: `${ hours }h`,\n    };\n  }\n\n  return {\n    diff:  60,\n    label: `${ hours }h${ minutes - (hours * 60) }m`,\n  };\n}\n","<script>\nimport day from 'dayjs';\nimport { DATE_FORMAT, TIME_FORMAT } from '@shell/store/prefs';\nimport { escapeHtml } from '@shell/utils/string';\nimport { diffFrom } from '@shell/utils/time';\n\nexport default {\n  props: {\n    value: {\n      type:    [String, Number],\n      default: ''\n    },\n\n    addSuffix: {\n      type:    Boolean,\n      default: false,\n    },\n\n    addPrefix: {\n      type:    Boolean,\n      default: false\n    },\n\n    suffix: {\n      type:    String,\n      default: 'ago',\n    },\n\n    tooltipPlacement: {\n      type:    String,\n      default: 'auto'\n    },\n\n    showTooltip: {\n      type:    Boolean,\n      default: true\n    }\n  },\n\n  mounted() {\n    // Set initial value;\n    this.liveUpdate(day());\n  },\n\n  data() {\n    return { label: '-' };\n  },\n\n  computed: {\n    title() {\n      if ( !this.value ) {\n        return '';\n      }\n\n      const dateFormat = escapeHtml( this.$store.getters['prefs/get'](DATE_FORMAT));\n      const timeFormat = escapeHtml( this.$store.getters['prefs/get'](TIME_FORMAT));\n\n      const out = day(this.value).format(`${ dateFormat } ${ timeFormat }`);\n\n      return out;\n    },\n\n    suffixedLabel() {\n      if (!this.value) {\n        // If there is no value, then do not show the suffix\n        return this.label;\n      }\n\n      let out = this.label || '';\n\n      if (out && this.addSuffix) {\n        const exists = this.$store.getters['i18n/exists'];\n        const suffixKey = `suffix.${ this.suffix }`;\n        const suffix = exists(suffixKey) ? this.t(suffixKey) : this.suffix;\n\n        out = `${ out } ${ suffix }`;\n      }\n\n      return out;\n    },\n\n    dayValue() {\n      if (!this.value) {\n        return null;\n      }\n\n      return day(this.value);\n    }\n  },\n\n  watch: {\n    value() {\n      this.liveUpdate(day());\n    }\n  },\n\n  methods: {\n    liveUpdate(now) {\n      if (!this.dayValue) {\n        if (this.label !== '-') {\n          this.label = '-';\n        }\n\n        return 300;\n      }\n\n      const diff = diffFrom(this.dayValue, now);\n      const prefix = (diff.diff < 0 || !this.addPrefix ? '' : '-');\n\n      let label = diff.label;\n\n      if ( diff.diff === 0 ) {\n        label = 'Just now';\n      } else {\n        label += ` ${ prefix }${ this.t(diff.unitsKey, { count: diff.label }) }`;\n        label = label.trim();\n      }\n\n      if ( this.label !== label ) {\n        this.label = label;\n      }\n\n      return diff.next || 1;\n    },\n  }\n};\n</script>\n\n<template>\n  <span\n    v-if=\"!suffixedLabel\"\n    class=\"text-muted\"\n  >\n    &mdash;\n  </span>\n  <span\n    v-else-if=\"showTooltip\"\n    v-clean-tooltip=\"{content: title, placement: tooltipPlacement}\"\n    class=\"live-date\"\n  >\n    {{ suffixedLabel }}\n  </span>\n  <span\n    v-else\n    class=\"live-date\"\n  >\n    {{ suffixedLabel }}\n  </span>\n</template>\n","import mod from \"-!../../../../cache-loader/dist/cjs.js??ref--14-0!../../../../thread-loader/dist/cjs.js!../../../../babel-loader/lib/index.js!../../../../cache-loader/dist/cjs.js??ref--2-0!../../../../@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./LiveDate.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../../cache-loader/dist/cjs.js??ref--14-0!../../../../thread-loader/dist/cjs.js!../../../../babel-loader/lib/index.js!../../../../cache-loader/dist/cjs.js??ref--2-0!../../../../@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./LiveDate.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./LiveDate.vue?vue&type=template&id=3163ddc7\"\nimport script from \"./LiveDate.vue?vue&type=script&lang=js\"\nexport * from \"./LiveDate.vue?vue&type=script&lang=js\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../@vue/cli-service/node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<script>\nimport { mapGetters } from 'vuex';\nimport LiveDate from '@shell/components/formatter/LiveDate.vue';\nimport { loadComponent, mapKind, loadStackStateSettings } from '../modules/stackstate';\nimport { isStackStateObserved } from '../modules/observed';\nimport HealthState from './Health/HealthState.vue';\n\nexport default {\n  name:       'MonitorTab',\n  components: { HealthState, LiveDate },\n  props:      { resource: Object },\n  data() {\n    return {\n      observed: false,\n      urn:      '',\n      url:      '',\n      monitors: [],\n    };\n  },\n  computed:   {\n    ...mapGetters(['currentCluster']),\n\n    clusterId() {\n      return this.currentCluster?.id;\n    },\n\n    hasMonitors() {\n      return this.monitors.length > 0;\n    },\n\n    componentIdentifier() {\n      const cluster = this.currentCluster?.spec.displayName;\n\n      if (!cluster) {\n        return '';\n      }\n\n      let identifier = `urn:kubernetes:/${ cluster }`;\n\n      if (this.resource.metadata.namespace) {\n        identifier += `:${ this.resource.metadata.namespace }`;\n      }\n\n      identifier += `:${ mapKind(this.resource.type.toLowerCase()) }/${ this.resource.metadata.name }`;\n\n      return identifier;\n    },\n  },\n  async fetch() {\n    const obs = await isStackStateObserved(this.$store, this.clusterId);\n\n    this.observed = obs.length > 0;\n\n    if (!this.observed) {\n      return;\n    }\n    const creds = await loadStackStateSettings(this.$store);\n\n    this.urn = this.componentIdentifier;\n\n    const component = await loadComponent(this.$store, creds, this.urn);\n\n    this.monitors = component.syncedCheckStates;\n\n    this.url = creds.spec.url;\n  },\n};\n</script>\n<template>\n  <div v-if=\"!observed\">\n    <div class=\"card\">\n      <span>Rancher Observability is not enabled for this cluster.</span>\n    </div>\n  </div>\n  <div v-else-if=\"!hasMonitors\">\n    <div class=\"card\">\n      <span>No monitors found for this component.</span>\n    </div>\n  </div>\n  <div v-else class=\"sortable-table-list-container\">\n    <table width=\"100%\" class=\"sortable-table top-divider\">\n      <thead>\n        <tr>\n          <th align=\"left\" class=\"sortable\" width=\"110px\">\n            <div class=\"table-header-container\">\n              <span>State</span>\n            </div>\n          </th>\n          <th align=\"left\">\n            <div class=\"table-header-container\">\n              <span>Monitor</span>\n            </div>\n          </th>\n          <th align=\"left\">\n            <div class=\"table-header-container\">\n              <span>Last update</span>\n            </div>\n          </th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr\n          v-for=\"mon in monitors\"\n          :key=\"mon.checkStateId\"\n          class=\"main-row\"\n        >\n          <td class=\"col-badge-state-formatter\" align=\"center\">\n            <HealthState :state=\"mon.health\" />\n          </td>\n          <td>\n            <a :href=\"`https://${url}/#/components/${encodeURIComponent(urn)}`\" target=\"_blank\">{{ mon.name }}</a>\n          </td>\n          <td><LiveDate :value=\"mon.lastUpdateTimestamp\" /></td>\n        </tr>\n      </tbody>\n    </table>\n  </div>\n  </div>\n</template>\n<style lang=\"scss\" scoped>\ntable.sortable-table {\n  border-collapse: collapse;\n  width: 100%;\n  outline: 1px solid var(--border);\n  background: var(--sortable-table-bg);\n}\ndiv.card {\n  line-height: 19px;\n  font-size: 14px;\n  align-items: center;\n  display: flex;\n}\n\nspan.spacer {\n  margin-left: 4px;\n}\n\n.table-header-container span {\n  line-height: 28px;\n  height: 28px;\n  font-weight: 400;\n}\n\nthead tr {\n  background: var(--sortable-table-header-bg);\n  border-bottom: 1px solid var(--border);\n}\n\nth:first-of-type {\n  padding-left: 10px;\n  padding-right: 5px;\n  padding-top: 8px;\n  padding-bottom: 8px\n}\n\nth {\n  padding: 8px 5px;\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--2-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./MonitorTab.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--2-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./MonitorTab.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./MonitorTab.vue?vue&type=template&id=7670cde8&scoped=true\"\nimport script from \"./MonitorTab.vue?vue&type=script&lang=js\"\nexport * from \"./MonitorTab.vue?vue&type=script&lang=js\"\nimport style0 from \"./MonitorTab.vue?vue&type=style&index=0&id=7670cde8&prod&lang=scss&scoped=true\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"7670cde8\",\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('span',[_c('div',{class:`healthstate-${_vm.badgeColor}`},[_c('span',[_vm._v(_vm._s(_vm.state))])])])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<script>\nexport default {\n  name:  'HealthState',\n  props: {\n    state: { type: String, default: 'UNKNOWN' },\n    color: { type: String, default: null }\n  },\n\n  computed: {\n    badgeColor() {\n      if (this.color) {\n        return this.color;\n      } else {\n        switch (this.state) {\n        case 'CLEAR':\n          return 'green';\n        case 'DEVIATING':\n          return 'orange';\n        case 'CRITICAL':\n          return 'red';\n        case 'UNKNOWN':\n        case 'NOT MONITORED':\n          return 'grey';\n        }\n      }\n\n      return this.state;\n    },\n  },\n};\n</script>\n<template>\n  <span>\n    <div :class=\"`healthstate-${badgeColor}`\">\n      <span>{{ state }}</span>\n    </div>\n  </span>\n</template>\n\n<style lang=\"scss\" scoped>\n.healthstate-green {\n  color: rgb(43, 158, 64);\n  border-color: rgb(43, 158, 64);\n}\n\n.healthstate-orange {\n  color: rgb(255, 138, 30);\n  border-color: rgb(255, 138, 30);\n}\n\n.healthstate-red {\n  border-color: rgb(235, 87, 87);\n  color: rgb(235, 87, 87);\n}\n\n.healthstate-grey {\n  border-color: rgb(135, 142, 152);\n  color: rgb(135, 142, 152);\n}\n\n.healthstate-orange,\n.healthstate-red,\n.healthstate-grey,\n.healthstate-green {\n  display: inline-block;\n  border-width: 1px;\n  border-style: solid;\n  border-radius: 20px;\n  padding: 2px 10px;\n  height: 21px;\n  line-height: 16px;\n  text-transform: uppercase;\n  font-size: 0.75rem;\n  letter-spacing: 0.3px;\n  font-weight: 500;\n}\n</style>\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--2-0!../../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./HealthState.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--2-0!../../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./HealthState.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./HealthState.vue?vue&type=template&id=a8e366d2&scoped=true\"\nimport script from \"./HealthState.vue?vue&type=script&lang=js\"\nexport * from \"./HealthState.vue?vue&type=script&lang=js\"\nimport style0 from \"./HealthState.vue?vue&type=style&index=0&id=a8e366d2&prod&lang=scss&scoped=true\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"a8e366d2\",\n  null\n  \n)\n\nexport default component.exports","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../node_modules/@vue/cli-service/node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"table.sortable-table[data-v-7670cde8]{border-collapse:collapse;width:100%;outline:1px solid var(--border);background:var(--sortable-table-bg)}div.card[data-v-7670cde8]{line-height:19px;font-size:14px;align-items:center;display:flex}span.spacer[data-v-7670cde8]{margin-left:4px}.table-header-container span[data-v-7670cde8]{line-height:28px;height:28px;font-weight:400}thead tr[data-v-7670cde8]{background:var(--sortable-table-header-bg);border-bottom:1px solid var(--border)}th[data-v-7670cde8]:first-of-type{padding-left:10px;padding-right:5px;padding-top:8px;padding-bottom:8px}th[data-v-7670cde8]{padding:8px 5px}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","export * from \"-!../../../node_modules/vue-style-loader/index.js??ref--10-oneOf-1-0!../../../node_modules/@vue/cli-service/node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-3!../../../node_modules/sass-loader/dist/cjs.js??ref--10-oneOf-1-4!../../../node_modules/cache-loader/dist/cjs.js??ref--2-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./MonitorTab.vue?vue&type=style&index=0&id=7670cde8&prod&lang=scss&scoped=true\"","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../node_modules/@vue/cli-service/node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-3!../../../../node_modules/sass-loader/dist/cjs.js??ref--10-oneOf-1-4!../../../../node_modules/cache-loader/dist/cjs.js??ref--2-0!../../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./HealthState.vue?vue&type=style&index=0&id=a8e366d2&prod&lang=scss&scoped=true\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"798030ed\", content, true, {\"sourceMap\":false,\"shadowMode\":false});","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../node_modules/@vue/cli-service/node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-3!../../../node_modules/sass-loader/dist/cjs.js??ref--10-oneOf-1-4!../../../node_modules/cache-loader/dist/cjs.js??ref--2-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./MonitorTab.vue?vue&type=style&index=0&id=7670cde8&prod&lang=scss&scoped=true\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"16b10458\", content, true, {\"sourceMap\":false,\"shadowMode\":false});","export * from \"-!../../../../node_modules/vue-style-loader/index.js??ref--10-oneOf-1-0!../../../../node_modules/@vue/cli-service/node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-3!../../../../node_modules/sass-loader/dist/cjs.js??ref--10-oneOf-1-4!../../../../node_modules/cache-loader/dist/cjs.js??ref--2-0!../../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./HealthState.vue?vue&type=style&index=0&id=a8e366d2&prod&lang=scss&scoped=true\"","export async function isStackStateObserved(store: any, clusterId: string): Promise<any> {\n  const response = await store.dispatch(`cluster/request`, { url: `/k8s/clusters/${ clusterId }/v1/apps.deployments` });\n\n  return response.data.filter((depl: any) => depl.metadata.labels && depl.metadata.labels['app.kubernetes.io/name'] === 'stackstate-k8s-agent');\n}\n"],"sourceRoot":""}