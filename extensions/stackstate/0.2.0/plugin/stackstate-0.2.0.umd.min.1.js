(("undefined"!==typeof self?self:this)["webpackJsonpstackstate_0_2_0"]=("undefined"!==typeof self?self:this)["webpackJsonpstackstate_0_2_0"]||[]).push([[1],{3466:function(t,a,e){"use strict";e("7c2d")},"7c2d":function(t,a,e){var s=e("ed19");s.__esModule&&(s=s.default),"string"===typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);var i=e("0ed3").default;i("26590d0a",s,!0,{sourceMap:!1,shadowMode:!1})},"88a4":function(t,a,e){"use strict";e.r(a);var s=function(){var t=this,a=t._self._c;return t.loading?a("div",[a("Loading")],1):t.isObserved?a("div",[a("div",{staticClass:"card"},[t._m(1),a("span",{staticClass:"spacer"},[t._v(" ")]),a("div",[a("span",[t._v("Cluster health:")]),a("span",{staticClass:"spacer"},[t._v(" ")]),a("HealthState",{attrs:{state:"observed",color:"green"}})],1)]),t._m(2),a("div",[a("HealthDisc",{attrs:{state:"DEVIATING"}}),t._v(" Deviating: "),a("span",{staticClass:"spacer"},[t._v(" ")]),t._v(" "+t._s(t.countDeviating)+" ")],1),a("div",[a("HealthDisc",{attrs:{state:"CRITICAL"}}),t._v(" Critical: "),a("span",{staticClass:"spacer"},[t._v(" ")]),t._v(" "+t._s(t.countCritical)+" ")],1)]):a("div",[a("div",{staticClass:"card"},[t._m(0),a("span",{staticClass:"spacer"},[t._v(" ")]),a("div",[a("span",[t._v("Cluster is")]),a("span",{staticClass:"spacer"},[t._v(" ")]),a("HealthState",{attrs:{state:"unobserved",color:"grey"}})],1)]),a("span",[t._v("Cluster is not observed by StackState. Please "),a("a",{attrs:{href:`/c/${t.resource.id}/apps/charts/chart?repo-type=cluster&repo=rancher-partner-charts&chart=stackstate-k8s-agent`}},[t._v("install")]),t._v(" the agent")])])},i=[function(){var t=this,a=t._self._c;return a("span",[a("img",{staticStyle:{width:"50px"},attrs:{src:e("a16d"),alt:"StackState logo"}})])},function(){var t=this,a=t._self._c;return a("span",[a("img",{staticStyle:{width:"50px"},attrs:{src:e("a16d"),alt:"StackState logo"}})])},function(){var t=this,a=t._self._c;return a("div",[a("span",[t._v("Component healths:")])])}],c=e("15ca"),r=e("dd22");async function n(t,a){const e=await t.dispatch("cluster/request",{url:`/k8s/clusters/${a}/v1/apps.deployments`});return e.data.filter(t=>t.metadata.labels&&"stackstate-k8s-agent"===t.metadata.labels["app.kubernetes.io/name"])}var l=e("706e"),o=function(){var t=this,a=t._self._c;return a("div",{class:"healthdisc-"+t.state})},d=[],h={name:"HealthDisc",props:{state:String}},p=h,u=(e("ecc8"),e("d802")),v=Object(u["a"])(p,o,d,!1,null,"c960f274",null),f=v.exports,_={name:"StackStateObservedCard",components:{Loading:c["a"],HealthState:l["a"],HealthDisc:f},props:{resource:Object},computed:{countDeviating(){return this.deviating},countHealthy(){return this.healthy},countCritical(){return this.critical},isObserved(){return this.observed.length>0}},data(){return{observed:void 0,snapshot:void 0,deviating:0,critical:0,healthy:0,loading:!0}},async fetch(){const t=await n(this.$store,this.resource.id),a=await Object(r["e"])(this.$store);this.snapshot=await Object(r["a"])(this.$store,`not healthstate in ("CLEAR", "UNKNOWN") AND label = "cluster-name:${this.resource.spec.displayName}"`,a);for(const e of this.snapshot.viewSnapshotResponse.components)"DEVIATING"===e.state.healthState?this.deviating++:"CRITICAL"===e.state.healthState?this.critical++:"HEALTHY"===e.state.healthState&&this.healthy++;this.observed=t,this.loading=!1}},g=_,b=(e("3466"),Object(u["a"])(g,s,i,!1,null,"358d3488",null));a["default"]=b.exports},a16d:function(t,a,e){t.exports=e.p+"img/sts-color.ff0814a4.svg"},e27c:function(t,a,e){var s=e("f18a");s.__esModule&&(s=s.default),"string"===typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);var i=e("0ed3").default;i("252c3b25",s,!0,{sourceMap:!1,shadowMode:!1})},ecc8:function(t,a,e){"use strict";e("e27c")},ed19:function(t,a,e){var s=e("5eaa");a=s(!1),a.push([t.i,"div.card[data-v-358d3488]{line-height:19px;font-size:14px;align-items:center;display:flex}span.spacer[data-v-358d3488]{margin-left:4px}.alert[data-v-358d3488]{display:flex;align-items:center;padding:10px;margin:10px 0;border-radius:5px}",""]),t.exports=a},f18a:function(t,a,e){var s=e("5eaa");a=s(!1),a.push([t.i,".healthdisc-CLEAR[data-v-c960f274]{background-color:#2b9e40}.healthdisc-DEVIATING[data-v-c960f274]{background-color:#ff8a1e}.healthdisc-CRITICAL[data-v-c960f274]{background-color:#eb5757}.healthdisc-UNKNOWN[data-v-c960f274]{background-color:#878e98}.healthdisc-CLEAR[data-v-c960f274],.healthdisc-CRITICAL[data-v-c960f274],.healthdisc-DEVIATING[data-v-c960f274],.healthdisc-UNKNOWN[data-v-c960f274]{display:inline-block;box-sizing:border-box;border-radius:9999px;width:8px;height:8px}",""]),t.exports=a}}]);
//# sourceMappingURL=stackstate-0.2.0.umd.min.1.js.map