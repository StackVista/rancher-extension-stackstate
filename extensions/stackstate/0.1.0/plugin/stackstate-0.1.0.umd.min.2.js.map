{"version":3,"sources":["webpack://stackstate-0.1.0/./components/StackStateObservedCard.vue","webpack://stackstate-0.1.0/components/StackStateObservedCard.vue","webpack://stackstate-0.1.0/./components/StackStateObservedCard.vue?5bd7","webpack://stackstate-0.1.0/./components/StackStateObservedCard.vue?25d9","webpack://stackstate-0.1.0/./components/StackStateObservedCard.vue?557c","webpack://stackstate-0.1.0/./components/StackStateObservedCard.vue?f531","webpack://stackstate-0.1.0/./components/StackStateObservedCard.vue?3bc1"],"names":["render","_vm","this","_c","_self","loading","isObserved","staticClass","_m","_v","attrs","_s","countDeviating","countCritical","resource","id","staticRenderFns","staticStyle","require","name","components","Loading","HealthState","HealthDisc","props","Object","computed","deviating","countHealthy","healthy","critical","observed","length","data","undefined","snapshot","obs","isStackStateObserved","$store","creds","loadStackStateSettings","getSnapshot","spec","displayName","component","viewSnapshotResponse","state","healthState","___CSS_LOADER_API_IMPORT___","exports","push","module","i","content","__esModule","default","locals","add"],"mappings":"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","file":"stackstate-0.1.0.umd.min.2.js","sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return (_vm.loading)?_c('div',[_c('Loading')],1):(!_vm.isObserved)?_c('div',[_c('div',{staticClass:\"card\"},[_vm._m(0),_c('span',{staticClass:\"spacer\"},[_vm._v(\" \")]),_c('div',[_c('span',[_vm._v(\"Cluster is\")]),_c('span',{staticClass:\"spacer\"},[_vm._v(\" \")]),_c('HealthState',{attrs:{\"state\":\"unobserved\",\"color\":\"grey\"}})],1)]),_c('span',[_vm._v(\"Cluster is not observed by StackState. Please \"),_c('a',{attrs:{\"href\":`/c/${_vm.resource.id}/apps/charts/chart?repo-type=cluster&repo=rancher-partner-charts&chart=stackstate-k8s-agent`}},[_vm._v(\"install\")]),_vm._v(\" the agent\")])]):_c('div',[_c('div',{staticClass:\"card\"},[_vm._m(1),_c('span',{staticClass:\"spacer\"},[_vm._v(\" \")]),_c('div',[_c('span',[_vm._v(\"Cluster health:\")]),_c('span',{staticClass:\"spacer\"},[_vm._v(\" \")]),_c('HealthState',{attrs:{\"state\":\"observed\",\"color\":\"green\"}})],1)]),_c('div',[_c('span',[_vm._v(\"Component healths:\")]),_c('span',{staticClass:\"spacer\"},[_vm._v(\" \")]),_vm._v(\" \"+_vm._s(_vm.countDeviating)+\" \"),_c('span',{staticClass:\"spacer\"},[_vm._v(\" \")]),_c('HealthDisc',{attrs:{\"state\":\"DEVIATING\"}}),_c('span',{staticClass:\"spacer\"},[_vm._v(\" \")]),_vm._v(\" \"+_vm._s(_vm.countCritical)+\" \"),_c('span',{staticClass:\"spacer\"},[_vm._v(\" \")]),_c('HealthDisc',{attrs:{\"state\":\"CRITICAL\"}})],1)])\n}\nvar staticRenderFns = [function (){var _vm=this,_c=_vm._self._c;return _c('span',[_c('img',{staticStyle:{\"width\":\"50px\"},attrs:{\"src\":require(\"../sts-color.svg\"),\"alt\":\"StackState logo\"}})])\n},function (){var _vm=this,_c=_vm._self._c;return _c('span',[_c('img',{staticStyle:{\"width\":\"50px\"},attrs:{\"src\":require(\"../sts-color.svg\"),\"alt\":\"StackState logo\"}})])\n}]\n\nexport { render, staticRenderFns }","<script>\nimport Loading from '@shell/components/Loading';\nimport { getSnapshot, loadStackStateSettings } from '../modules/stackstate';\nimport { isStackStateObserved } from '../modules/observed';\nimport HealthState from './HealthState.vue';\nimport HealthDisc from './HealthDisc.vue';\n\nexport default {\n  name:       'StackStateObservedCard',\n  components: {\n    Loading, HealthState, HealthDisc\n  },\n  props:      { resource: Object },\n  computed:   {\n    countDeviating() {\n      return this.deviating;\n    },\n    countHealthy() {\n      return this.healthy;\n    },\n    countCritical() {\n      return this.critical;\n    },\n    isObserved() {\n      return this.observed.length > 0;\n    },\n  },\n  data() {\n    return {\n      observed:  undefined,\n      snapshot:  undefined,\n      deviating: 0,\n      critical:  0,\n      healthy:   0,\n      loading:   true,\n    };\n  },\n  async fetch() {\n    const obs = await isStackStateObserved(this.$store, this.resource.id);\n    const creds = await loadStackStateSettings(this.$store);\n\n    this.snapshot = await getSnapshot(this.$store, `not healthstate in (\"CLEAR\", \"UNKNOWN\") AND label = \"cluster-name:${ this.resource.spec.displayName }\"`, creds);\n    for (const component of this.snapshot.viewSnapshotResponse.components) {\n      if (component.state.healthState === 'DEVIATING') {\n        this.deviating++;\n      } else if (component.state.healthState === 'CRITICAL') {\n        this.critical++;\n      } else if (component.state.healthState === 'HEALTHY') {\n        this.healthy++;\n      }\n    }\n    this.observed = obs;\n    this.loading = false;\n  },\n};\n</script>\n<template>\n  <div v-if=\"loading\">\n    <Loading />\n  </div>\n  <div v-else-if=\"!isObserved\">\n    <div class=\"card\">\n      <span><img src=\"../sts-color.svg\" alt=\"StackState logo\" style=\"width: 50px;\" /></span>\n      <span class=\"spacer\">&nbsp;</span>\n      <div>\n        <span>Cluster is</span>\n        <span class=\"spacer\">&nbsp;</span>\n        <HealthState state=\"unobserved\" color=\"grey\" />\n      </div>\n    </div>\n    <span>Cluster is not observed by StackState. Please <a :href=\"`/c/${resource.id}/apps/charts/chart?repo-type=cluster&repo=rancher-partner-charts&chart=stackstate-k8s-agent`\">install</a> the agent</span>\n  </div>\n  <div v-else>\n    <div class=\"card\">\n      <span><img src=\"../sts-color.svg\" alt=\"StackState logo\" style=\"width: 50px;\" /></span>\n      <span class=\"spacer\">&nbsp;</span>\n      <div>\n        <span>Cluster health:</span>\n        <span class=\"spacer\">&nbsp;</span>\n        <HealthState state=\"observed\" color=\"green\" />\n      </div>\n    </div>\n    <div>\n      <span>Component healths:</span>\n      <span class=\"spacer\">&nbsp;</span>\n      {{ countDeviating }}\n      <span class=\"spacer\">&nbsp;</span>\n      <HealthDisc state=\"DEVIATING\" />\n      <span class=\"spacer\">&nbsp;</span>\n      {{ countCritical }}\n      <span class=\"spacer\">&nbsp;</span>\n      <HealthDisc state=\"CRITICAL\" />\n    </div>\n  </div>\n  </div>\n</template>\n<style lang=\"scss\" scoped>\ndiv.card {\n  line-height: 19px;\n  font-size: 14px;\n  align-items: center;\n  display: flex;\n}\n\nspan.spacer {\n  margin-left: 4px;\n}\n\n  .alert {\n    display: flex;\n    align-items: center;\n    padding: 10px;\n    margin: 10px 0;\n    border-radius: 5px;\n  }\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--2-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./StackStateObservedCard.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--2-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./StackStateObservedCard.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./StackStateObservedCard.vue?vue&type=template&id=1b40eef6&scoped=true\"\nimport script from \"./StackStateObservedCard.vue?vue&type=script&lang=js\"\nexport * from \"./StackStateObservedCard.vue?vue&type=script&lang=js\"\nimport style0 from \"./StackStateObservedCard.vue?vue&type=style&index=0&id=1b40eef6&prod&lang=scss&scoped=true\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"1b40eef6\",\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../../node_modules/vue-style-loader/index.js??ref--10-oneOf-1-0!../../../node_modules/@vue/cli-service/node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-3!../../../node_modules/sass-loader/dist/cjs.js??ref--10-oneOf-1-4!../../../node_modules/cache-loader/dist/cjs.js??ref--2-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./StackStateObservedCard.vue?vue&type=style&index=0&id=1b40eef6&prod&lang=scss&scoped=true\"","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../node_modules/@vue/cli-service/node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"div.card[data-v-1b40eef6]{line-height:19px;font-size:14px;align-items:center;display:flex}span.spacer[data-v-1b40eef6]{margin-left:4px}.alert[data-v-1b40eef6]{display:flex;align-items:center;padding:10px;margin:10px 0;border-radius:5px}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../node_modules/@vue/cli-service/node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-3!../../../node_modules/sass-loader/dist/cjs.js??ref--10-oneOf-1-4!../../../node_modules/cache-loader/dist/cjs.js??ref--2-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!./StackStateObservedCard.vue?vue&type=style&index=0&id=1b40eef6&prod&lang=scss&scoped=true\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"73e869ee\", content, true, {\"sourceMap\":false,\"shadowMode\":false});"],"sourceRoot":""}