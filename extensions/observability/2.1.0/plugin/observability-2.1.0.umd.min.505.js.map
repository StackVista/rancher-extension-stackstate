{"version":3,"file":"observability-2.1.0.umd.min.505.js","mappings":"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","sources":["webpack://observability-2.1.0/./modules/observed.ts","webpack://observability-2.1.0/./components/Health/HealthState.vue","webpack://observability-2.1.0/./components/Health/HealthState.vue?e2ab","webpack://observability-2.1.0/./components/MonitorTab.vue","webpack://observability-2.1.0/./components/MonitorTab.vue?e881","webpack://observability-2.1.0/./components/Health/HealthState.vue?105a","webpack://observability-2.1.0/./components/MonitorTab.vue?9e95","webpack://observability-2.1.0/./components/Health/HealthState.vue?5303","webpack://observability-2.1.0/./components/MonitorTab.vue?ccd8"],"sourcesContent":["export async function isObserved(\n  store: any,\n  clusterId: string\n): Promise<any> {\n  const response = await store.dispatch(`cluster/request`, { url: `/k8s/clusters/${ clusterId }/v1/apps.deployments` });\n\n  return response?.data?.filter(\n    (depl: any) => depl.metadata?.labels && (\n      depl.metadata.labels['app.kubernetes.io/name'] === 'suse-observability-agent' ||\n      // backwards compatibility\n      depl.metadata.labels['app.kubernetes.io/name'] === 'stackstate-k8s-agent')\n  );\n}\n","<script>\nimport { HEALTH_STATE_TYPES } from '../../types/types';\n\nexport default {\n  name:  'HealthState',\n  props: {\n    health: { type: String, default: null },\n    color:  { type: String, default: null },\n  },\n\n  computed: {\n    badgeColor() {\n      if (this.color) {\n        return this.color;\n      }\n\n      switch (this.health) {\n      case HEALTH_STATE_TYPES.CLEAR:\n        return 'green';\n      case HEALTH_STATE_TYPES.DEVIATING:\n        return 'orange';\n      case HEALTH_STATE_TYPES.CRITICAL:\n        return 'red';\n      case HEALTH_STATE_TYPES.UNKNOWN:\n      case HEALTH_STATE_TYPES.NOT_MONITORED:\n        return 'grey';\n      default:\n        return 'skeleton';\n      }\n    },\n  },\n};\n</script>\n<template>\n  <span :class=\"`healthstate healthstate-${badgeColor}`\">\n    {{ health ?? \"LOADING\" }}\n  </span>\n</template>\n\n<style lang=\"scss\" scoped>\n.healthstate-green {\n  color: rgb(43, 158, 64);\n}\n\n.healthstate-orange {\n  color: rgb(255, 138, 30);\n}\n\n.healthstate-red {\n  color: rgb(235, 87, 87);\n}\n\n.healthstate-grey {\n  color: rgb(135, 142, 152);\n}\n\n.healthstate-skeleton {\n  cursor: wait;\n  color: rgb(217, 217, 217);\n  background-color: rgb(217, 217, 217);\n}\n\n.healthstate {\n  display: inline-block;\n  border-width: 1px;\n  border-style: solid;\n  border-radius: 20px;\n  padding: 2px 10px;\n  height: 21px;\n  line-height: 16px;\n  text-transform: uppercase;\n  font-size: 0.75rem;\n  letter-spacing: 0.3px;\n  font-weight: 500;\n}\n</style>\n","import { render } from \"./HealthState.vue?vue&type=template&id=2ec76faa&scoped=true\"\nimport script from \"./HealthState.vue?vue&type=script&lang=js\"\nexport * from \"./HealthState.vue?vue&type=script&lang=js\"\n\nimport \"./HealthState.vue?vue&type=style&index=0&id=2ec76faa&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-2ec76faa\"]])\n\nexport default __exports__","<script>\nimport { mapGetters } from 'vuex';\nimport LiveDate from '@shell/components/formatter/LiveDate.vue';\nimport SortableTable from '@shell/components/SortableTable';\n\nimport { loadComponent, mapKind, loadSuseObservabilitySettings, isCrdLoaded } from '../modules/suseObservability';\nimport { isObserved } from '../modules/observed';\nimport { MONITOR_HEADERS } from '../types/headers';\n\nimport HealthState from './Health/HealthState.vue';\n\nexport default {\n  name:       'MonitorTab',\n  components: {\n    SortableTable, HealthState, LiveDate\n  },\n  props:      {\n    resource: {\n      type:     Object,\n      required: true,\n    }\n  },\n  data() {\n    return {\n      MONITOR_HEADERS,\n      observed: false,\n      urn:      '',\n      url:      '',\n      monitors: [],\n    };\n  },\n  computed:   {\n    ...mapGetters(['currentCluster']),\n\n    clusterId() {\n      return this.currentCluster?.id;\n    },\n\n    hasMonitors() {\n      return this.monitors?.length > 0;\n    },\n\n    componentIdentifier() {\n      const cluster = this.currentCluster?.spec.displayName;\n\n      if (!cluster) {\n        return '';\n      }\n\n      let identifier = `urn:kubernetes:/${ cluster }`;\n\n      if (this.resource?.metadata?.namespace) {\n        identifier += `:${ this.resource.metadata.namespace }`;\n      }\n\n      identifier += `:${ mapKind(this.resource?.type?.toLowerCase()) }/${ this.resource?.metadata?.name }`;\n\n      return identifier;\n    },\n  },\n  async fetch() {\n    if (!isCrdLoaded(this.$store)) {\n      return;\n    }\n\n    const obs = await isObserved(this.$store, this.clusterId);\n\n    this.observed = obs?.length > 0;\n\n    if (!this.observed) {\n      return;\n    }\n    const settings = await loadSuseObservabilitySettings(this.$store);\n\n    this.urn = this.componentIdentifier;\n\n    const component = await loadComponent(this.$store, settings, this.urn);\n\n    if (!component) {\n      return;\n    }\n\n    this.monitors = component.syncedCheckStates;\n\n    this.url = settings.spec.url;\n  },\n};\n</script>\n<template>\n  <div v-if=\"!observed\">\n    <div class=\"card\">\n      <span>{{ t('components.monitorTab.notEnabled') }}</span>\n    </div>\n  </div>\n  <div v-else-if=\"!hasMonitors\">\n    <div class=\"card\">\n      <span>{{ t('components.monitorTab.noMonitors') }}</span>\n    </div>\n  </div>\n  <SortableTable\n    v-else\n    :rows=\"monitors\"\n    :headers=\"MONITOR_HEADERS\"\n    :table-actions=\"false\"\n    :row-actions=\"false\"\n    key-field=\"checkStateId\"\n    default-sort-by=\"state\"\n    :paging=\"true\"\n    :rows-per-page=\"40\"\n  >\n    <template #col:state=\"{row}\">\n      <td>\n        <HealthState :health=\"row.health\" />\n      </td>\n    </template>\n\n    <template #col:monitor=\"{row}\">\n      <td>\n        <a\n          :href=\"`https://${url}/#/components/${encodeURIComponent(urn)}`\"\n          target=\"_blank\"\n          rel=\"nofollow noopener noreferrer\"\n        >{{ row.name }}</a>\n      </td>\n    </template>\n\n    <template #col:lastUpdate=\"{row}\">\n      <td>\n        <LiveDate :value=\"row.lastUpdateTimestamp\" />\n      </td>\n    </template>\n  </SortableTable>\n</template>\n\n<style lang=\"scss\" scoped>\ndiv.card {\n  line-height: 19px;\n  font-size: 14px;\n  align-items: center;\n  display: flex;\n}\n\nspan.spacer {\n  margin-left: 4px;\n}\n</style>\n","import { render } from \"./MonitorTab.vue?vue&type=template&id=45c8d05f&scoped=true\"\nimport script from \"./MonitorTab.vue?vue&type=script&lang=js\"\nexport * from \"./MonitorTab.vue?vue&type=script&lang=js\"\n\nimport \"./MonitorTab.vue?vue&type=style&index=0&id=45c8d05f&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-45c8d05f\"]])\n\nexport default __exports__","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../../../node_modules/css-loader/dist/runtime/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".healthstate-green[data-v-2ec76faa]{color:#2b9e40}.healthstate-orange[data-v-2ec76faa]{color:#ff8a1e}.healthstate-red[data-v-2ec76faa]{color:#eb5757}.healthstate-grey[data-v-2ec76faa]{color:#878e98}.healthstate-skeleton[data-v-2ec76faa]{cursor:wait;color:#d9d9d9;background-color:#d9d9d9}.healthstate[data-v-2ec76faa]{display:inline-block;border-width:1px;border-style:solid;border-radius:20px;padding:2px 10px;height:21px;line-height:16px;text-transform:uppercase;font-size:.75rem;letter-spacing:.3px;font-weight:500}\", \"\"]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \"div.card[data-v-45c8d05f]{line-height:19px;font-size:14px;align-items:center;display:flex}span.spacer[data-v-45c8d05f]{margin-left:4px}\", \"\"]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../node_modules/css-loader/dist/cjs.js??clonedRuleSet-23.use[1]!../../../../node_modules/vue-loader/dist/stylePostLoader.js!../../../../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-23.use[2]!../../../../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-23.use[3]!../../../../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-23.use[4]!../../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../../node_modules/vue-loader/dist/index.js??ruleSet[0].use[1]!./HealthState.vue?vue&type=style&index=0&id=2ec76faa&lang=scss&scoped=true\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"ada042fc\", content, true, {\"sourceMap\":false,\"shadowMode\":false});","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../node_modules/css-loader/dist/cjs.js??clonedRuleSet-23.use[1]!../../../node_modules/vue-loader/dist/stylePostLoader.js!../../../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-23.use[2]!../../../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-23.use[3]!../../../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-23.use[4]!../../../node_modules/cache-loader/dist/cjs.js??ruleSet[0].use[0]!../../../node_modules/vue-loader/dist/index.js??ruleSet[0].use[1]!./MonitorTab.vue?vue&type=style&index=0&id=45c8d05f&lang=scss&scoped=true\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"01aa474c\", content, true, {\"sourceMap\":false,\"shadowMode\":false});"],"names":["async","isObserved","store","clusterId","response","dispatch","url","data","filter","depl","metadata","labels","_createElementBlock","class","_normalizeClass","$options","badgeColor","$props","health","name","props","type","String","default","color","computed","this","HEALTH_STATE_TYPES","CLEAR","DEVIATING","CRITICAL","UNKNOWN","NOT_MONITORED","__exports__","render","$data","observed","hasMonitors","_createBlock","_component_SortableTable","rows","monitors","headers","MONITOR_HEADERS","paging","_withCtx","row","_createElementVNode","_createVNode","_component_HealthState","href","encodeURIComponent","urn","target","rel","_hoisted_5","_component_LiveDate","value","lastUpdateTimestamp","_hoisted_3","_hoisted_4","_toDisplayString","_ctx","t","_hoisted_1","_hoisted_2","components","SortableTable","HealthState","LiveDate","resource","Object","required","mapGetters","currentCluster","id","length","componentIdentifier","cluster","spec","displayName","identifier","namespace","mapKind","toLowerCase","fetch","isCrdLoaded","$store","obs","settings","loadSuseObservabilitySettings","component","loadComponent","syncedCheckStates","___CSS_LOADER_EXPORT___","push","module","content","__esModule","locals","exports","add"],"sourceRoot":""}